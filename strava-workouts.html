<!DOCTYPE html>

	


<html lang="en">
	<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link rel="stylesheet" type="text/css" href="style.css">
	<link rel="shortcut icon" type="image/png" href="images/favicon.png"/>
	<title>lorem</title>


    <style type="text/css">
        
        #workouts {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-around;
}

.workout {
    border: 1px solid #ddd;
    padding: 10px;
    margin: 10px;
    width: 250px;
}

.workout h3 {
    margin-bottom: 5px;
}


    </style>

    </head>
    
    <body>  

         <h1>My Latest Strava Workouts</h1>
    <div id="workouts"></div>
    <script src="script.js"></script>





 

    <script type="text/javascript">const clientId = '124696'; // Replace with your client ID
const clientSecret = '3c5a2201dde046a9e0bf3048e0eab7bd5804a263'; // Replace with your client secret

// Authorization URL with your website's callback URL
const authUrl = `https://www.strava.com/oauth/authorize?client_id=${clientId}&redirect_uri=https://cristianrus.me/strava-workouts/callback&response_type=code&scope=read_all,activity:read_all`;

// Check if access token is already stored
const accessToken = localStorage.getItem('accessToken');


// Function to fetch access token (if not already stored)
async function getAccessToken(code) {
    const response = await fetch('https://www.strava.com/oauth/token', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            client_id: clientId,
            client_secret: clientSecret,
            code,
            grant_type: 'authorization_code'
        })
    });
    const data = await response.json();
    localStorage.setItem('accessToken', data.access_token);
    return data.access_token;
}

// Function to fetch and display workouts
async function fetchWorkouts(accessToken) {
    const response = await fetch(`https://www.strava.com/api/v3/athlete/activities?per_page=5&access_token=${accessToken}`);
    const workouts = await response.json();

    const workoutsContainer = document.getElementById('workouts');
    workoutsContainer.innerHTML = ''; // Clear previous workouts

    workouts.forEach(workout => {
        const workoutElement = document.createElement('div');
        workoutElement.classList.add('workout');

        const title = document.createElement('h3');
        title.textContent = workout.name;
        workoutElement.appendChild(title);

        // Add other workout details as needed (e.g., distance, time, date)

        workoutsContainer.appendChild(workoutElement);
    });
}

// Handle authorization flow (if access token is not stored)
if (!accessToken) {
    window.location.href = authUrl;
} else {
    fetchWorkouts(accessToken);
}

// Handle callback URL (if authorization is successful)
const urlParams = new URLSearchParams(window.location.search);
const code = urlParams.get('code');
if (code) {
    getAccessToken(code)
        .then(accessToken => fetchWorkouts(accessToken));
}
</script>





	</body>

	

</html>
	